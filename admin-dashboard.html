<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุชุญูู ุงูุงุญุชุฑุงููุฉ</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        /* -------------------------------------
        1. Base Variables & Theme Setup
        ------------------------------------- */
        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --sidebar-bg: #2d3748; /* ุฃุฒุฑู ุบุงูู ุงุญุชุฑุงูู */
            --sidebar-link-hover: #4a5568;
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
            --primary-color: #0d6efd;
        }

        /* Dark Mode Overrides */
        body.dark-mode {
            --bg-color: #1a202c;
            --text-color: #edf2f7;
            --sidebar-bg: #171923;
            --sidebar-link-hover: #2d3748;
            --card-bg: #2d3748;
            --border-color: #4a5568;
        }

        /* -------------------------------------
        2. Custom Styling
        ------------------------------------- */
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        .sidebar {
            background-color: var(--sidebar-bg);
            color: var(--text-color);
            padding-top: 10px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
        }
        
        /* ุฌุนู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ุซุงุจุชุฉ ุนูู ุงูุดุงุดุงุช ุงููุจูุฑุฉ */
        @media (min-width: 768px) {
            .sidebar {
                position: fixed;
                height: 100vh;
                top: 0;
                right: 0;
            }
            main {
                margin-right: 16.666667%; /* 2/12 of the screen width */
            }
        }

        .sidebar a {
            color: #edf2f7; /* ููู ุซุงุจุช ูููุต ุฏุงุฎู ุงูุดุฑูุท ุงูุฌุงูุจู */
            padding: 12px;
            display: block;
            text-decoration: none;
            border-radius: 8px;
            margin: 5px 10px;
            transition: background 0.3s;
        }

        .sidebar a.active,
        .sidebar a:hover {
            background-color: var(--sidebar-link-hover);
            color: white;
        }
        
        .card {
            background-color: var(--card-bg);
            border-color: var(--border-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: background-color 0.3s;
        }

        .table {
            color: var(--text-color);
        }

        .table> :not(caption)>*>* {
            border-color: var(--border-color);
        }
    </style>
</head>

<body>

    <div id="dashboard" class="container-fluid">
        <div class="row">

            <nav class="col-12 col-md-2 sidebar">
                <h4 class="text-center py-3 border-bottom border-light-subtle mb-3">ููุญุฉ ุงูุชุญูู</h4>
                
                <div class="d-grid gap-2 mx-3 mb-4">
                    <button class="btn btn-sm" id="theme-toggle" style="background-color: #344054; color: white;">
                        <i class="bi bi-moon-fill me-2"></i> ุงููุถุน ุงูุฏุงูู
                    </button>
                </div>
                
                <a href="#" class="active" data-tab="subscribers"><i class="bi bi-people-fill me-2"></i> ุงููุดุชุฑููู</a>
                <a href="#" data-tab="reports"><i class="bi bi-graph-up me-2"></i> ุงูุชูุงุฑูุฑ</a>
                <a href="#" data-tab="plans"><i class="bi bi-credit-card-2-front-fill me-2"></i> ุงูุจุงูุงุช</a>
                <a href="#" data-tab="payments"><i class="bi bi-cash-stack me-2"></i> ุงููุฏููุนุงุช</a>
                
                <div class="border-top border-light-subtle mx-3 my-2"></div>
                <a href="#" id="btn-logout"><i class="bi bi-box-arrow-right me-2"></i> ุชุณุฌูู ุงูุฎุฑูุฌ</a>
                <a href="./index.html" id="btn-logout"><i class="bi bi-box-arrow-right me-2"></i>  ุงูุตูุญุฉ ุงูุฑูููุณูุฉ</a>
            </nav>

            <main class="col-12 col-md-10 p-4">

                <h1 class="mb-4">ููุฎุต ุงูุฃุฏุงุก ๐</h1>
                
                <div class="row g-4 mb-4">
                    <div class="col-12 col-sm-6 col-lg-3">
                        <div class="card p-3 text-center">
                            <i class="bi bi-person-check-fill fs-3 text-primary mb-2"></i>
                            <h5 class="card-title">ุฅุฌูุงูู ุงููุดุชุฑููู</h5>
                            <p class="fs-4 fw-bold" id="total-subs">450</p>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-lg-3">
                        <div class="card p-3 text-center">
                            <i class="bi bi-calendar-check-fill fs-3 text-success mb-2"></i>
                            <h5 class="card-title">ุงุดุชุฑุงูุงุช ูุฐุง ุงูุดูุฑ</h5>
                            <p class="fs-4 fw-bold">85</p>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-lg-3">
                        <div class="card p-3 text-center">
                            <i class="bi bi-currency-dollar fs-3 text-warning mb-2"></i>
                            <h5 class="card-title">ุฅูุฑุงุฏุงุช ุงูุดูุฑ</h5>
                            <p class="fs-4 fw-bold">15,000 ุฌ.ู</p>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-lg-3">
                        <div class="card p-3 text-center">
                            <i class="bi bi-arrow-down-up fs-3 text-danger mb-2"></i>
                            <h5 class="card-title">ูุชูุณุท ุงูุชุบูุฑ</h5>
                            <p class="fs-4 fw-bold">-2.5%</p>
                        </div>
                    </div>
                </div>


                <section id="subscribers" class="tab">
                    <h4 class="mb-3">ูุงุฆูุฉ ุงููุดุชุฑููู <i class="bi bi-people-fill"></i></h4>
                    
                    <div class="d-flex justify-content-end mb-3">
                         <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#subscriberModal" onclick="prepareSubscriberModal('add')">
                            <i class="bi bi-plus-circle me-1"></i> ุฅุถุงูุฉ ูุดุชุฑู ุฌุฏูุฏ
                        </button>
                    </div>

                    <div class="card p-4">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead>
                                    <tr>
                                        <th>ุงูุงุณู</th>
                                        <th>ุงููุงุชู</th>
                                        <th>ุงูุจุงูุฉ</th>
                                        <th>ุงูุญุงูุฉ</th>
                                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                                    </tr>
                                </thead>
                                <tbody id="subs-body">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                
                <section id="reports" class="tab d-none">
                    <h4 class="mb-3">ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช <i class="bi bi-graph-up"></i></h4>
                    <div class="card p-4">
                        <p>ููุง ุชุธูุฑ ุงูุฑุณูู ุงูุจูุงููุฉ ูุงูุฌุฏุงูู ุงูุฅุญุตุงุฆูุฉ ุงููุชูุฏูุฉ ูุฃุฏุงุก ุงููุธุงู.</p>
                        <div class="alert alert-info">
                            <strong>ููุญูุธุฉ:</strong> ูู ุงููุณุฎุฉ ุงูุญููููุฉุ ูุชู ุนุฑุถ ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ (ุจุงุณุชุฎุฏุงู ููุชุจุงุช ูุซู Chart.js).
                        </div>
                    </div>
                </section>

                <section id="plans" class="tab d-none">
                    <h4 class="mb-3">ุงูุจุงูุงุช <i class="bi bi-credit-card"></i></h4>
                    <div class="card p-4">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>ุงูุงุณู</th>
                                    <th>ุงููุฏุฉ</th>
                                    <th>ุงูุณุนุฑ</th>
                                </tr>
                            </thead>
                            <tbody id="plans-body"></tbody>
                        </table>
                    </div>
                </section>

                <section id="payments" class="tab d-none">
                    <h4 class="mb-3">ุงููุฏููุนุงุช <i class="bi bi-cash"></i></h4>
                    <div class="card p-4">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>ุงููุดุชุฑู</th>
                                    <th>ุงูุจุงูุฉ</th>
                                    <th>ุงููุจูุบ</th>
                                    <th>ุงูุชุงุฑูุฎ</th>
                                </tr>
                            </thead>
                            <tbody id="payments-body"></tbody>
                        </table>
                    </div>
                </section>

            </main>
        </div>
    </div>
    
    <div class="modal fade" id="subscriberModal" tabindex="-1" aria-labelledby="subscriberModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="subscriberModalLabel">ุฅุถุงูุฉ / ุชุนุฏูู ูุดุชุฑู</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="subscriber-form">
                <input type="hidden" id="sub-id"> <div class="mb-3">
                    <label for="sub-name" class="form-label">ุงูุงุณู</label>
                    <input type="text" class="form-control" id="sub-name" required>
                </div>
                <div class="mb-3">
                    <label for="sub-phone" class="form-label">ุงููุงุชู</label>
                    <input type="text" class="form-control" id="sub-phone" required>
                </div>
                <div class="mb-3">
                    <label for="sub-plan" class="form-label">ุงูุจุงูุฉ</label>
                    <select id="sub-plan" class="form-select" required>
                        <option value="ุดูุฑู">ุดูุฑู</option>
                        <option value="ุณููู">ุณููู</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="sub-status" class="form-label">ุงูุญุงูุฉ</label>
                    <select id="sub-status" class="form-select" required>
                        <option value="ูุดุท">ูุดุท</option>
                        <option value="ููุชูู">ููุชูู</option>
                        <option value="ูุนูู">ูุนูู</option>
                    </select>
                </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ุฅูุบุงุก</button>
            <button type="submit" form="subscriber-form" class="btn btn-primary" id="modal-submit-btn">ุญูุธ</button>
          </div>
        </div>
      </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // -------------------------------------
        // 1. Dark Mode Logic
        // -------------------------------------
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;

        // Load saved theme or default to light
        function updateThemeDisplay() {
             if (body.classList.contains('dark-mode')) {
                themeToggle.innerHTML = '<i class="bi bi-sun-fill me-2"></i> ุงููุถุน ุงููุงุชุญ';
            } else {
                themeToggle.innerHTML = '<i class="bi bi-moon-fill me-2"></i> ุงููุถุน ุงูุฏุงูู';
            }
        }
        
        if (localStorage.getItem('theme') === 'dark') {
            body.classList.add('dark-mode');
        }
        updateThemeDisplay();

        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('theme', 'dark');
            } else {
                localStorage.setItem('theme', 'light');
            }
            updateThemeDisplay();
        });


        // -------------------------------------
        // 2. Data and CRUD Logic (Local Storage)
        // -------------------------------------

        // Initialize subscribers array and load from Local Storage
        let subscribers = JSON.parse(localStorage.getItem('subscribers')) || [
            { id: 1, name: 'ุฃุญูุฏ ุฌูุงู', phone: '0100xxxxxxx', plan: 'ุดูุฑู', status: 'ูุดุท' },
            { id: 2, name: 'ุณุงุฑุฉ ุนูู', phone: '0114xxxxxxx', plan: 'ุณููู', status: 'ููุชูู' }
        ];

        // Function to render the table and update totals
        function renderSubscribers() {
            const subsBody = document.getElementById('subs-body');
            subsBody.innerHTML = ''; 

            subscribers.forEach(sub => {
                const row = subsBody.insertRow();
                let statusClass;
                if (sub.status === 'ูุดุท') statusClass = 'text-success';
                else if (sub.status === 'ููุชูู') statusClass = 'text-danger';
                else statusClass = 'text-warning';
                
                row.innerHTML = `
                    <td>${sub.name}</td>
                    <td>${sub.phone}</td>
                    <td>${sub.plan}</td>
                    <td class="${statusClass} fw-bold">${sub.status}</td>
                    <td>
                        <button class="btn btn-sm btn-info text-white edit-btn me-2" 
                                data-id="${sub.id}" 
                                data-bs-toggle="modal" 
                                data-bs-target="#subscriberModal" 
                                onclick="prepareSubscriberModal('edit', ${sub.id})">
                            <i class="bi bi-pencil-square"></i> ุชุนุฏูู
                        </button>
                        <button class="btn btn-sm btn-danger delete-btn" data-id="${sub.id}">
                            <i class="bi bi-trash-fill"></i> ุญุฐู
                        </button>
                    </td>
                `;
            });

            // Update Total Subscribers Card
            document.getElementById('total-subs').textContent = subscribers.length;
            
            attachDeleteListeners();
            localStorage.setItem('subscribers', JSON.stringify(subscribers));
        }
        
        // Prepare the Modal for Add or Edit
        function prepareSubscriberModal(mode, id = null) {
            const modalTitle = document.getElementById('subscriberModalLabel');
            const submitBtn = document.getElementById('modal-submit-btn');
            const form = document.getElementById('subscriber-form');
            form.reset(); 

            if (mode === 'add') {
                modalTitle.textContent = 'ุฅุถุงูุฉ ูุดุชุฑู ุฌุฏูุฏ';
                submitBtn.textContent = 'ุฅุถุงูุฉ';
                document.getElementById('sub-id').value = '';
                document.getElementById('sub-status').value = 'ูุดุท'; // Default status
            } else if (mode === 'edit') {
                modalTitle.textContent = 'ุชุนุฏูู ุจูุงูุงุช ุงููุดุชุฑู';
                submitBtn.textContent = 'ุญูุธ ุงูุชุนุฏููุงุช';
                
                const subscriber = subscribers.find(sub => sub.id === id);
                if (subscriber) {
                    document.getElementById('sub-id').value = subscriber.id;
                    document.getElementById('sub-name').value = subscriber.name;
                    document.getElementById('sub-phone').value = subscriber.phone;
                    document.getElementById('sub-plan').value = subscriber.plan;
                    document.getElementById('sub-status').value = subscriber.status;
                }
            }
        }

        // Handle Form Submission (Add or Edit)
        document.getElementById('subscriber-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const id = document.getElementById('sub-id').value;
            const name = document.getElementById('sub-name').value;
            const phone = document.getElementById('sub-phone').value;
            const plan = document.getElementById('sub-plan').value;
            const status = document.getElementById('sub-status').value;

            if (id) {
                // Editing existing subscriber
                const index = subscribers.findIndex(sub => sub.id === parseInt(id));
                if (index !== -1) {
                    subscribers[index] = { ...subscribers[index], name, phone, plan, status };
                }
            } else {
                // Adding new subscriber
                const newSubscriber = {
                    id: Date.now(), 
                    name: name,
                    phone: phone,
                    plan: plan,
                    status: status
                };
                subscribers.push(newSubscriber);
            }

            renderSubscribers(); 
            // Close the modal manually
            const modalElement = document.getElementById('subscriberModal');
            const modal = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
            modal.hide();
        });


        // Delete Subscriber functionality
        function deleteSubscriber(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุดุชุฑู ููุงุฆูุงูุ')) {
                subscribers = subscribers.filter(sub => sub.id !== id);
                renderSubscribers(); 
            }
        }

        // Attach listeners to delete buttons
        function attachDeleteListeners() {
            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const idToDelete = parseInt(this.getAttribute('data-id'));
                    deleteSubscriber(idToDelete);
                });
            });
        }
        
        // Initial render on load
        window.onload = renderSubscribers;


        // -------------------------------------
        // 3. Tab Switching and Dummy Data
        // -------------------------------------

        // Tab Switching Logic
        document.querySelectorAll(".sidebar a[data-tab]").forEach(a => {
            a.addEventListener("click", (e) => {
                e.preventDefault(); 
                document.querySelectorAll(".sidebar a").forEach(x => x.classList.remove("active"));
                a.classList.add("active");

                document.querySelectorAll(".tab").forEach(tab => tab.classList.add("d-none"));
                const targetTab = document.getElementById(a.dataset.tab);
                if(targetTab) targetTab.classList.remove("d-none");
            });
        });

        // Dummy Data for other tabs
        document.getElementById("plans-body").innerHTML = `
            <tr><td>ุงูุจุงูุฉ ุงูุดูุฑูุฉ</td><td>30 ููู</td><td>300 ุฌููู</td></tr>
            <tr><td>ุงูุจุงูุฉ ุงูุณูููุฉ</td><td>365 ููู</td><td>3000 ุฌููู</td></tr>
        `;

        document.getElementById("payments-body").innerHTML = `
            <tr><td>ุฃุญูุฏ ุฌูุงู</td><td>ุดูุฑู</td><td>300</td><td>2025-01-10</td></tr>
            <tr><td>ุณุงุฑุฉ ุนูู</td><td>ุณููู</td><td>3000</td><td>2025-02-01</td></tr>
        `;

        // Logout simulation
        document.getElementById("btn-logout").onclick = (e) => {
            e.preventDefault();
            alert("ุชูุช ูุญุงูุงุฉ ุชุณุฌูู ุงูุฎุฑูุฌ. ุณูุชู ุชุญุฏูุซ ุงูุตูุญุฉ.");
            window.location.reload(); 
        };
        
        // Make the prepareSubscriberModal function accessible globally
        window.prepareSubscriberModal = prepareSubscriberModal;
    </script>

</body>

</html>